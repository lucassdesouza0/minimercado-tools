<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MiniMercado - Leitor CSV</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://accounts.google.com/gsi/client" async defer></script>
  </head>
  <body>
    <main class="page">
      <header class="page__header">
        <div>
          <p class="page__eyebrow">MiniMercado Tools</p>
          <h1>Leitor de CSV, Excel e Google Sheets de produtos</h1>
          <p class="page__subtitle">
            Carregue um arquivo CSV, XLSX ou Google Sheet com o cabeçalho esperado e filtre os
            itens pela coluna <strong>Descrição</strong>.
          </p>
        </div>
        <div class="page__actions">
          <div id="googleAuthContainer" style="display: none; gap: 10px; align-items: center;">
            <div id="buttonDiv"></div>
            <div id="googleStatus" style="font-size: 0.9em; color: #666;">Desconectado</div>
          </div>
          <label class="file-input" for="csvFile">
            <input id="csvFile" type="file" accept=".csv,.xlsx" />
            <span>Escolher arquivo CSV ou XLSX</span>
          </label>
        </div>
      </header>

      <section class="controls">
        <div class="control" id="googleFileControl" hidden>
          <label for="googleFileSelect">Planilha do Google Drive</label>
          <select id="googleFileSelect" disabled>
            <option value="">Carregando arquivos...</option>
          </select>
        </div>
        <div class="control">
          <label for="searchInput">Buscar pela descrição</label>
          <input
            id="searchInput"
            type="search"
            placeholder="Ex.: Arroz, Leite..."
            disabled
          />
        </div>
        <div class="control" id="sheetControl" hidden>
          <label for="sheetSelect">Aba da planilha</label>
          <select id="sheetSelect" disabled>
            <option value="">Selecione uma aba</option>
          </select>
        </div>
        <div class="control control--summary">
          <span class="summary" id="resultSummary">Nenhum arquivo carregado</span>
          <span class="summary" id="filteredSummary">0 itens</span>
        </div>
      </section>

      <section class="todo">
        <header class="todo__header">
          <div>
            <h2>Todo list</h2>
            <p class="todo__hint">
              Gerencie tarefas com status <strong>Pending</strong>, <strong>Done</strong> e
              <strong>Archived</strong>. Os itens carregados da planilha viram tarefas
              automaticamente e todas as ações podem ser desfeitas.
            </p>
          </div>
          <div class="todo__header-actions">
            <button class="button button--ghost" id="todoUndo" type="button" disabled>
              Desfazer
            </button>
            <span class="todo__history" id="todoHistoryLabel">Nenhuma ação para desfazer</span>
          </div>
        </header>

        <form class="todo__form" id="todoForm">
          <label class="todo__label" for="todoInput">Nova tarefa</label>
          <div class="todo__input-group">
            <input
              id="todoInput"
              type="text"
              placeholder="Digite uma tarefa..."
              autocomplete="off"
              required
            />
            <button class="button" type="submit">Adicionar</button>
          </div>
        </form>

        <div class="todo__controls">
          <div class="todo__filters" role="tablist" aria-label="Filtros da lista">
            <button class="chip chip--active" type="button" data-todo-filter="all">Todos</button>
            <button class="chip" type="button" data-todo-filter="Pending">Pending</button>
            <button class="chip" type="button" data-todo-filter="Done">Done</button>
            <button class="chip" type="button" data-todo-filter="Archived">Archived</button>
          </div>
          <div class="todo__summary" id="todoSummary">0 itens</div>
        </div>

        <ul class="todo__list" id="todoList"></ul>
        <div class="todo__empty" id="todoEmptyState">
          Nenhuma tarefa criada. Adicione uma tarefa ou carregue itens da planilha.
        </div>
      </section>

      <section class="cards-display" aria-live="polite">
        <div class="cards-display__header">
          <h2>Itens encontrados</h2>
          <p class="cards-display__hint">
            Visualização em cards com foco em Descrição, Custo, Custo Médio e Estoque.
          </p>
        </div>
        <div class="cards-display__list" id="cardList"></div>
      </section>
    </main>

    <script
      src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"
    ></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="config.js"></script>
    <script src="app.js"></script>
  </body>
</html>
